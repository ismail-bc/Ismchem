Hi

This code in not generalized so issues can ariese.
I haven't checked if it works for all the types of functional groups.

It is better to change the 'atom_type_lst' to only contain atoms that are in your data mostly to reduce the time takes if your data is hugh.
you can add any type of bond as long as it is supported by rdkit.

you enter a list of SMILES in the function and it will give you a nested list of numbers that represent different mainatoms and their connections.

if you found a bug and fixed it or generalized the code you can publish the code as your own or message me and i will update this code.

Hope you have a nice life :)
